\documentclass[a4paper, 12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage{amsmath,amssymb,amsthm}
\usepackage[a4paper,hmargin=2.5cm,vmargin=2.5cm]{geometry}
\usepackage[english,russian]{babel}
\usepackage{tikz-cd}

\newtheorem{proposition}{Proposition}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\newtheorem{statement}{Statement}
\newtheorem{theorem}{Theorem}

\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{example}{Example}

\newtheorem{property}{Property}

\theoremstyle{remark}
\newtheorem{remark}{Remark}

% \newenvironment{pf}{\noindent\textbf{Proof.} ~ \par}{\qed}
\newenvironment{pf}{\noindent\textbf{Proof.}}{\qed}
\newcommand{\define}[1]{{\textit{#1}}}

\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}

\title{Approximate Homological Version of Quillen-McCord Theorem}
\author{Vitalii Guzeev, Anton Ayzenberg}

\begin{document}

\section{Abstract}

Combinatorial topology has recently been successfully applied to data analysis. One approach is to compute homology groups of some persistence complex constructed by experimental data and try to classify some objects by them. However complexity of computation of persistent homology is high enough to limit practical usage of the approach.\\

There is a question of how to construct persistence complex with same homology as initially given with smaller dimension. Some of complexes arise from dynamics of some partially ordered set by nerve construction. In this paper we prove Quillen-McCord theorem (Quillen fiber lemma) in the setting of persistent homology. It can possibly be used to reduce persistence complex built from poset to smaller one.

\section{Preliminaries}

\subsection{Persistence modules and $\varepsilon$-interleavings}

Basic definition is the following:

\begin{definition}
  \define{Persistence complex} is a family of chain complexes $C_{\star}^{i_0} \xrightarrow{f_{i_0}} C_{\star}^{i_1} \xrightarrow{f_{i_1}} C_{\star}^{i_2} \xrightarrow{f_{i_2}} \ldots$ where $I$ is the set of indices and $f_i$ are chain maps. We will call $f=(\ldots,f_i,\ldots)$ \define{the structure maps} of a persistence complex.
\end{definition}

These objects naturally arise in experiments. If we consider $I$ as a measure of time, this is a structure we obtain while observing some dynamic structure which can at any time be represented by a chain complex.\\

\begin{definition}
  Let $R$ be a ring. \define{Persistence module} is a family of $R$-modules $M^i$ with homomorpisms $\phi_i :: M^i \to M^{i+1}$ as the structure maps. If $R$ is a field it is natural to use notion of \define{persistence vector space}.
\end{definition}

Example of a persistence module is given by homology modules of persistence complex $C_{\star}$ (\define{persistent homology}). $H_i^j(C_{\star}) = H_i(C_{j})$, maps $\phi_j$ are induced by $f_i$.\\

\begin{definition}
  Persistence complex (module) is of \define{finite type} over $R$ if all components of complexes (modules) are finitely-generated as $R$-modules and all $f_i$ ($\phi_i$) are isomorphisms for $i > m$ for some $m$.
\end{definition}

Since experiments usually take finite time and operate finite amount of data, we can safely consider only complexes of finite type. Note that by construction homology of complex of finite type is a module of finite type.\\

\begin{definition}
  \define{Graded module} over $I$-graded ring $R$ with graded components $R_i$ is an $R$-module $M$ together with a decomposition $M = \bigoplus_{j \in I} M^j:\; \forall i \in I\, R_i \cdot M^j \subset M^{j+i}$. For correctness of the definition it's enough for $I$ to be a semigroup.
\end{definition}

% Why only linear?
\begin{definition}
  Assume $I$ is a monoid with linear order. Then \define{non-negatively graded module} over $I$-graded ring $R$ is an $R$-module $M$ together with a decomposition $M = \bigoplus_{j \in I} M^j:\; \forall i \in I_{\geq 0}\, R_i \cdot M^j \subset M^{j+i}$
\end{definition}

\begin{proposition} ~ \par
  \begin{enumerate}
    \item Graded modules over $R$ form a category.
    \item Non-negatively graded modules over $R$ form a category.
  \end{enumerate}
\end{proposition}

Morphisms in both these categories are morphisms $\phi$ between modules $M$ and $N$ such that $\phi(M^j) \subset N^j$ for all $j$ in indexing set.\\

\begin{theorem} {\cite[Theorem 3.1]{Zomorodian05}}\\
  Category of persistence modules of finite type over Noetherian ring with unity $R$ is equivalent to category of non-negatively graded finitely generated $R[t]$-modules.
\end{theorem}

For clarification of the reference see {\cite{Corbet18}}

\begin{remark}
  If $R$ is a field then $R[t]$ is a PID and graded ideals are exactly $t^n$ for $n \in I_{\geq 0}$.
\end{remark}

We have introduced a setting to work with persistence complexes as with graded modules. However computations in a category of non-negatively graded modules are not fit for applications since experiment always comes with an error and we do not have a measure for similarity of two persistence modules. We need technique which allows to construct morphisms of deformed complexes and track error propagation. This technique is developed in {\cite{GS16}}, we recall it without proofs.\\

\begin{definition} {\cite[Definition 2.7]{GS16}}\\
  Let $M$ and $N$ be persistence modules, $f : M \to N$ be a homomorphism of modules. Then $f$ is called \define{$\varepsilon$-morphism} if $f(M^j) \subset N^{j+\varepsilon}$ for $\varepsilon \geq 0$.
\end{definition}

\begin{remark}
  Note that $0$-morphism is a morphism in category of non-negatively graded modules over $R[t]$.
\end{remark}

\begin{remark}
  Let $\mathbb{F}$ be a field. Then for every persistence vector space $V$ over $\mathbb{F}$ and any $\varepsilon$ there exists morphism $Id_{\varepsilon}$ such that $Id_{\varepsilon}(a) = t^{\varepsilon}a$.
\end{remark}

\begin{definition}
  Persistence vector spaces $M$ and $N$ are called \define{$\varepsilon$-interleaved} ($M \stackrel{\varepsilon}{\sim} N$) if there exists pair of $\varepsilon$-morphisms $(\phi : M \to N,\;\psi : N \to M)$ (\define{$\varepsilon$-interleaving}) such that $\phi \circ \psi = Id_{2\varepsilon} : N \to N$ and $\psi \circ \phi = Id_{2\varepsilon} : M \to M$.
\end{definition}

\begin{remark}
There follows that $M \stackrel{\varepsilon}{\sim} N$ implies $M \stackrel{\alpha}{\sim} N$ for any $\alpha > \varepsilon$ since for $\varepsilon$-interleaving $(\phi, \psi)$ we have $\alpha$-interleaving $(Id_{\alpha - \varepsilon} \circ \phi, Id_{\alpha - \varepsilon} \circ \psi)$.
\end{remark}

\begin{remark}
  Note that due to Theorem 1 notion of $\varepsilon$-interleavings applies to persistence complexes.
\end{remark}

\begin{definition}
  We denote as \define{$\varepsilon$-equivalence} relation with the following properties:\\
  For any $M$, $N$, $L$, $\varepsilon$, $\varepsilon_1$, $\varepsilon_2$
  \begin{itemize}
    \item $M \stackrel{0}{\sim} M$.
    \item $M \stackrel{\varepsilon}{\sim} N$ is equivalent to $N \stackrel{\varepsilon}{\sim} M$.
    \item if $M \stackrel{\varepsilon_1}{\sim} N$ and $N \stackrel{\varepsilon_2}{\sim} L$ then $M \stackrel{\varepsilon_1 + \varepsilon_2}{\sim} L$.
  \end{itemize}
\end{definition}

\begin{proposition}
  $\varepsilon$-interleaved persistence vector spaces are $\varepsilon$-equivalent.
\end{proposition}

\begin{definition}
  Persistence vector space $M$ is called \define{$\varepsilon$-trivial} if $M \stackrel{\varepsilon}{\sim} 0$. This is equivalent to condition $t^{2\varepsilon}M = 0$.
\end{definition}

\begin{lemma}
  Let $0 \to M \to L \to N \to 0$ be a short exact sequence of persistence vector spaces. Then the following properties hold:
  \begin{itemize}
    \item If $M \stackrel{\varepsilon_1}{\sim} 0$ and $N \stackrel{\varepsilon_2}{\sim} 0$ then $L \stackrel{\varepsilon_1 + \varepsilon_2}{\sim} 0$.
    \item If $L \stackrel{\varepsilon}{\sim} 0$ then $M \stackrel{\varepsilon}{\sim} 0$ and $N \stackrel{\varepsilon}{\sim} 0$.
  \end{itemize}
\end{lemma}

\subsection{Quillen-McCord theorem}

In order to give a general context we formulate general theorem and deduce Quillen-McCord theorem as a special case.\\

\begin{definition}
  \define{Simplex category} $\Delta$ is the category with objects --- nonempty linearly ordered sets of the form $[n] = \{0,1,\ldots,n\}$ with $n \geq 0$ and morphisms --- order-preserving functions.
\end{definition}

All morphisms in the simplex category are compositions of injective maps $\delta_i^n : \{0,1,\ldots,i-1,i+1\ldots,n\} \mapsto \{0,1,\ldots,i-1,i,i+1,\ldots,n\}$ and surjective maps $\sigma^n_i : \{0,1,\ldots,i,i+1,i+2\ldots,n\} \mapsto \{0,1,\ldots,i,i+1,\ldots,n\}$.

\begin{definition}
  \define{Simplicial set} $S$ is a contravariant functor $\Delta \to Set$. Objects of image of $S$ are called simplices, cardinality of a simplex is called a dimension of a simplex. We will identify $s$ with set of its simplices while keeping in mind general structure.
\end{definition}

Simplicial sets form a category under natural transformations (category $Psh(\Delta)$ of presheaves on $\Delta$).\\

\begin{definition}
  Simplicial set $S$ is called a \define{simplicial complex} if for any $s \in S$ s.t. $v \subset s$  $v \in s$ and $S$ is faithful as a functor.
\end{definition}

We will also use the following definitions:

\begin{definition}
  \define{Join} $A \star B$ of simplicial complexes $A$ and $B$ is the simplicial complex with simplices --- all possible unions of simplices $a \in A$ and $b \in B$.
\end{definition}

\begin{definition}
  \define{Join} of topological spaces $A$ and $B$ is defined as follows: $A \star B\ := A \sqcup_{p_0} (A \times B \times [0,1]) \sqcup_{p_1} B$, where $p$ are projections of the cylinder $A \times B \times [0,1]$ onto faces.
\end{definition}

\begin{definition}
  \define{Star} $\operatorname{st}(x)$ of simplex $x \in A$ ($A$ simplicial complex) is the simplicial complex with simplices --- all simplices $a \in A$ such that there exists inclusion $x \hookrightarrow a$.
\end{definition}

\begin{definition}
  \define{Link} $\operatorname{lk}(x)$ of simplex $x \in A$ is defined as follows: $\operatorname{lk}(x) = \{v \in \operatorname{st}(x)|\; x \not\in v\}$.
\end{definition}

\begin{definition}
  Functor $\mathcal{K} : \Delta \to Top$ which maps simplices to geometric simplices of corresponding dimension and morphisms to inclusions of faces and restrictions to subcomplexes is called \define{geometric realization}.
\end{definition}

\begin{proposition}
  $\operatorname{st}(x) = \operatorname{lk}(x) \star x$.
\end{proposition}

\begin{proposition}
  $\mathcal{K}(A \star B) = \mathcal{K}(A) \star \mathcal{K}(B)$. Hence $\mathcal{K}(\operatorname{st}(x))$ is a cone over $\mathcal{K}(x)$.
\end{proposition}

Let $\mathcal{C}$ denote a small category. We can construct the simplicial set called \define{nerve of category $\mathcal{C}$} as follows:\\
Let objects of $\mathcal{C}$ be the only 0-dimensional simplices. Then let all morphisms be 1-dimensional simplices, all composable pairs of morphisms be 2-dimensional simplices and so on with morphisms ----- inclusions of compositions into longer ones and replacements of compositions $i \circ j$ with $f = i \circ j$.\\
This construction is functorial over category of small categories $Cat$, we denote nerve functor from $Cat$ to $Psh(\Delta)$ as $\mathcal{N}$.

\begin{definition}
  Geometric realization $B\mathcal{C}$ of $\mathcal{N}(\mathcal{C})$ is called \define{classifying space} of $\mathcal{C}$.\\

  We denote composition of nerve and geometric realization as $\mathcal{B}$. It is obviously a functor and we only need this construction to avoid confusing notation $Bf$ for induced morphism of classifying spaces. By definition $\mathcal{B}(\mathcal{C}) = B\mathcal{C}$.
\end{definition}

\begin{definition}
  Let $f: \mathcal{C} \to \mathcal{D}$ be a functor and $d$ --- object in $\mathcal{D}$. Then \define{comma category} $d \downarrow f$ is a category with objects --- pairs $(s,i_s)$ of objects in $\mathcal{C}$ and morphisms $i_s : d \to f(s)$ and morphisms --- morphisms $g$ in $\mathcal{C}$ such that triangle $i_s, i_{g(s)}, f(g)$ is commutative.
\end{definition}

\begin{theorem} {\cite[Theorem A]{Quillen72}}\\
  If $f: C \to D$ is a functor such that the classifying space $B(d \downarrow f)$ of the comma category $d \downarrow f$ is contractible for any object $d \in D$, then $f$ induces a homotopy equivalence $BC \to BD$.
\end{theorem}

Every poset $X$ with order relation $R$ can be seen as a category if we set $\operatorname{Ob}(X) = X$ and $Hom_X(a,b) = \{r_{ab}\}$ if $(a,b) \in R$ and $\emptyset$ otherwise. Note that map between posets is functorial if and only if it preserves order.\\
Nerve construction on a poset yields a simplicial complex called \define{order complex}. Application of Quillen A theorem to posets yields the following theorem:

\begin{theorem} \textbf{Quillen-McCord theorem}\\
  Assume $X, Y$ are finite posets, $f : X \to Y$ is order-preserving map.\\
  If $\forall y \in Y\;\mathcal{B}(f^{-1}(Y_{\leqslant y}))$ is contractible, then $\mathcal{B}f$ is a homotopy equivalence between $BX$ and $BY$.\\
\end{theorem}

There holds homological {\cite[Corollary 5.5]{Bar11}} versions of this theorem:

\begin{theorem} \textbf{Homological Quillen-McCord theorem}\\
  Assume $X, Y$ are finite posets, $f : X \to Y$ is order-preserving map, $R$ is a PID.\\
  If $\forall y \in Y\;H_i(\mathcal{B}(f^{-1}(Y_{\leqslant y})),R) = 0$ for any $i$, $\mathcal{B}f$ induces isomorphisms of all homology groups with coefficients in $R$ on $BX$ and $BY$.\\
\end{theorem}

Proofs of the theorem is necessary for construction of a desired result and will be recalled in section 2.4 as well as a specific proof of Quillen-McCord theorem {\cite[Proof of Theorem 1.1]{Bar11}}.\\

\subsection{Statement of the theorem}

Assume we conduct an experiment and observe dynamics of a simplicial complex $S^{i_0} \xrightarrow{f_{i_0}} S^{i_1} \xrightarrow{f_{i_1}} S^{i_2} \xrightarrow{f_{i_2}} \ldots$. Denote the whole sequence as $S$. For each simplicial complex $S^{i}$ we can assign chain complex $C_{\star}^{i}$ via standard construction of simplicial chain complex used in the definition of simplicial homology.\\

I.e. we observe persistence chain complex $C_{\star}^{i_0} \xrightarrow{f'_{i_0}} C_{\star}^{i_1} \xrightarrow{f'_{i_1}} C_{\star}^{i_2} \xrightarrow{f'_{i_2}} \ldots$. Each simplicial complex in a series has geometric realization with the same homology as its chain complex.

\begin{definition}
  We will denote as \define{persistence topological space} $X$ sequence of topological spaces $X^{i_0} \xrightarrow{f_{i_0}} X^{i_1} \xrightarrow{f_{i_1}} X^{i_2} \xrightarrow{f_{i_2}} \ldots$ with compatible triangulations (chain complexes formed by simplicial complexes) $C_{\star}^{i}$ such that $C_{\star}$ is a persistence complex with structure maps induced by $f_i$. Homology of $X$ is a persistence module with components --- homology modules of $X^i$.\\

  We will denote as morphism $g$ between persistence topological spaces $X$ and $Y$ collection of maps $g_i : X^i \to Y^i$ between components such that all $g_i$ commute with $f_i$.
\end{definition}

Apparently $\mathcal{K}S$ is a persistence topological space.\\

\begin{definition}
  Persistence topological space $X$ is called \define{$\varepsilon$-acyclic} over $\mathbb{F}$ if for all indices\\ $H_i(X,\mathbb{F}) \stackrel{\varepsilon}{\sim} H_i(pt,R)$.
\end{definition}

\begin{definition}
  We say that morphism $f : X \to Y$ between persistence topological spaces induces $\varepsilon$-interleaving if there exists $g : Y \to X$ such that induced maps of pair $(f,g)$ on graded homology modules form $\varepsilon$-interleaving.
\end{definition}

\begin{definition}
  We define \define{persistence poset} $P$ as possibly infinite in both directions series of posets $P_i$ with order-preserving structure maps.\\

  Map of persistence posets $X$, $Y$ is defined as collection of component-wise order-preserving maps commuting with structure maps.\\

  \define{Persistence poset of finite type} is a finite sequence of finite posets.
\end{definition}

  It's easy to see that nerve (as a functor) of persistence poset of finite type is a persistence complex of finite type.\\

\begin{theorem} \textbf{Approximate Quillen-McCord theorem, draft statement}\\
  Assume $X, Y$ are persistent posets of finite type, $f : X \to Y$ is order-preserving map, $\mathbb{F}$ is a field.\\
  If $\forall y=(\ldots,y_i,\ldots) \in Y\;\mathcal{B}(f^{-1}(Y_{\leqslant y}))$ is $\varepsilon$-acyclic over $\mathbb{F}$, $\mathcal{B}f$ induces $e$-interleavings of all homology spaces over $\mathbb{F}$ on $BX$ and $BY$.\\
\end{theorem}

Value of $e$ will be specified during the proof and is critical to applications being measure of error of approximation.

\subsection{Prerequisite results}

\subsubsection{Quillen-McCord theorem}

This section contains the proof of Quillen-McCord theorem given by Barmak.

\begin{proposition} {\cite[Proposition 2.1]{Bar11}}
  Let $X$ and $Y$ be two simplicial complexes. Then if $\mathcal{K}(X) \cup \mathcal{K}(Y) \hookrightarrow \mathcal{K}(X)$ is a homotopy equivalence, then so is $\mathcal{K}(Y) \hookrightarrow \mathcal{K}(X \cup Y)$.
\end{proposition}

\begin{proposition} {\cite[Proposition 2.2]{Bar11}}
  Let $f,g : X \to Y$ be order-preserving maps between finite posets such that $\forall x\;f(x) \leq g(x)$. Then $\mathcal{B}(f)$ is homotopy-equivalent to $\mathcal{B}(g)$.
\end{proposition}

\begin{pf}
  $X$ has a finite set $M$ of maximal elements. Take any of them ($m_1$) and define $h_1 : X \to Y$ such that $h_1(m_1) = g(m_1)$ and $h_1 = f$ on all other elements of $X$. This is an order-preserving map due to maximality of $m_1$. Take $M \setminus \{m_1\}$ and build $h_2$ which is equal to $h_1$ on complement to $m_2$ and to $g$ on $m_2$ and so on. We have built a finite sequence of maps $h_0 = f \leq h_1 \leq h_1 \leq \ldots \leq g = h_n$.\\

  Elements $h_i(m_i)$ and $h_{i-1}(m_i)$ are comparable. Hence there exists simplex $\{h_i(m_i); h_{i-1}(m_i)\}$ in $\mathcal{N}(Y)$. Since $\mathcal{N}(Y)$ is a simplicial complex, for other elements between selected where exist no holes and thus where is a linear homotopy between $h_{i-1}$ and $h_{i}$ which contracts simplex $\{h_i(m_i); h_{i-1}(m_i)\}$.\\

  Hence there is a homotopy between $f$ and $g$.
\end{pf}

\begin{proposition}
  Note that $\operatorname{lk}(\mathcal{N}(x)) = \mathcal{N}(X_{>x}) \star \mathcal{N}(X_{<x})$. Therefore $\mathcal{K}(\operatorname{lk}(\mathcal{N}(x))) = \mathcal{B}(X_{>x}) \star \mathcal{B}(X_{<x})$.
\end{proposition}

\begin{remark}
  $\mathcal{B}(X) = \mathcal{B}(X \setminus \{x\}) \cup \mathcal{K}(\operatorname{st}(\mathcal{N}(x)))$ for any $x \in X$.\\
\end{remark}

\begin{lemma}
  Let $X$ be a finite poset and for $x \in X$ either $\mathcal{B}(X_{>x})$ or $\mathcal{B}(X_{<x})$ is contractible. Then embedding $\mathcal{B}(X \setminus \{x\}) \hookrightarrow \mathcal{B}(X)$ is a homotopy equivalence.
\end{lemma}

\begin{pf}
  By proposition $\mathcal{K}(\operatorname{lk}(\mathcal{N}(x)))$ is contractible. Hence its embedding to its cone $\mathcal{K}(\operatorname{st}(\mathcal{N}(x)))$ is homotopy equivalence by Whitehead theorem. Lemma follows by Proposition 5.
\end{pf}

\begin{definition}
  Let $f : X \to Y$ be an order preserving map between posets. Denote orders ($\leq$) on $X$ and $Y$ as $R_X$ and $R_Y$. Then we define poset $M(f) = X \coprod Y$ with $R = R_X \cup R_Y \cup R_{f}$ where $(x,y) \in R_f$ if and only if $(f(x),y) \in R_Y$.\\

  We will by analogy denote this poset a \define{mapping cylinder} of $f$. There are also defined canonical inсlusions $i : X \to M(f)$ and $j : Y \to M(f)$.
\end{definition}

\begin{pf} \textbf{Quillen-McCord theorem}\\
  Let $X, Y$ be finite posets with order-preserving map $f : X \to Y$.\\

  Every poset has linear extension. Let $x_1, x_2, \ldots, x_n$ be enumeration of $X$ in such linear order and $Y^r = \{x_1,\ldots,x_r\} \cup Y \subset M(f)$ for any $r$.\\

  Consider $Y^r_{>x_r} = Y_{\geq f(x_r)}$. $\mathcal{B}(Y_{\geq f(x_r)})$ is a cone over $\mathcal{B}(f(x_r))$. It is contractible, therefore $\mathcal{B}(Y^{r-1}) \hookrightarrow \mathcal{B}(Y^{r})$ is homotopy equivalence by lemma. By iteration $\mathcal{B}(j) : \mathcal{B}(Y^{0}) = \mathcal{B}(Y) \hookrightarrow \mathcal{B}(M(f)) = \mathcal{B}(Y^n)$ is homotopy equivalence between $BY$ and $M(f)$.\\

  Then consider linear extension of $Y$ with enumeration $y_1,\ldots,y_m$ and $X^r = X \cup \{y_{r+1},\ldots,y_m\} \subset M(f)$. $X^{r-1}_{\leq y_r} = f^{-1}(Y_{\leqslant y_r})$. Latter is contractible by condition of the theorem. Hence $\mathcal{B}(X^{r}) \hookrightarrow \mathcal{B}(X^{r-1})$ is homotopy equivalence and by transitivity $\mathcal{B}(i)$ is a homotopy equivalence between $X$ and $M(f)$.\\

  Note that $i(x) \leqslant (j \circ f)(x)$. By Proposition 6 $\mathcal{B}(i)$ is homotopic to $\mathcal{B}(j \circ f) = \mathcal{B}(j) \circ \mathcal{B}(f)$. Hence $\mathcal{B}(f)$ is the homotopy equivalence between $BX$ and $BY$.
\end{pf}

\subsubsection{Homological Quillen-McCord theorem}

To derive homological version of the theorem we can variate the proof of standard version in the following manner:\\

\begin{proposition} {\cite[Lemma 2.1]{Milnor56}}
  Reduced homology modules with coefficients in a principal ideal domain of a join satisfy the relation
  $H_{r+1}(A \star B, R) \simeq \bigoplus_{i+j=r}(H_i(A,R) \otimes_R H_j(B,R)) \oplus \bigoplus_{i+j=r-1} \operatorname{Tor_1^R}(H_i(A,R),H_j(B,R))$.
\end{proposition}

\begin{lemma}
  Let $X$ be a finite poset and for $x \in X$ either $H_i(\mathcal{B}(X_{< x}))$ or $H_i(\mathcal{B}(X_{> x}))$ with coefficients in a PID are equal to homology of a point. Then embedding $\mathcal{B}(X \setminus \{x\}) \hookrightarrow \mathcal{B}(X)$ induces isomorphisms of all homology groups.
\end{lemma}

\begin{pf} ~ \par
  By Proposition 8 $H_i(\mathcal{K}(\operatorname{lk}(\mathcal{N}(x)))) = H_i(\mathcal{B}(X_{>x}) \star \mathcal{B}(X_{<x}))$ are trivial for all indices $i$ --- $Tor$-functors vanish if any of their arguments is trivial.
  Application of Mayer-Vietoris long exact sequence to covering from Remark 6 yields the lemma.
\end{pf}\\

Proof of the theorem is similar to proof finishing previous section. However, we write it here in detail in order to be able to highlight differences. Changed parts are written in italic.\\

\begin{pf} \textbf{Homological Quillen-McCord theorem}\\
Let $X, Y$ be finite posets with order-preserving map $f : X \to Y$.\\

Every poset has linear extension. Let $x_1, x_2, \ldots, x_n$ be enumeration of $X$ in such linear order and $Y^r = \{x_1,\ldots,x_r\} \cup Y \subset M(f)$ for any $r$.\\

Consider $Y^r_{>x_r} = Y_{\geq f(x_r)}$. $\mathcal{B}(Y_{\geq f(x_r)})$ is a cone over $\mathcal{B}(f(x_r))$. It is contractible, therefore $\mathcal{B}(Y^{r-1}) \hookrightarrow \mathcal{B}(Y^{r})$ is homotopy equivalence by lemma 2. By iteration $\mathcal{B}(j) : \mathcal{B}(Y^{0}) = \mathcal{B}(Y) \hookrightarrow \mathcal{B}(M(f)) = \mathcal{B}(Y^n)$ is homotopy equivalence between $BY$ and $M(f)$.\\

Then consider linear extension of $Y$ with enumeration $y_1,\ldots,y_m$ and $X^r = X \cup \{y_{r+1},\ldots,y_n\} \subset M(f)$. $X^{r-1}_{\leq y_r} = f^{-1}(Y_{\leqslant y_r})$. \textit{Latter is acyclic over $R$ by condition of the theorem. Hence $\mathcal{B}(X^{r}) \hookrightarrow \mathcal{B}(X^{r-1})$ induces isomorphisms of all homology groups and by functoriality of homology $\mathcal{B}(i)$ induces isomorphisms of all homology groups between $X$ and $M(f)$.}\\

Note that $i(x) \leqslant (j \circ f)(x)$. By Proposition 6 $\mathcal{B}(i)$ is homotopic to $\mathcal{B}(j \circ f) = \mathcal{B}(j) \circ \mathcal{B}(f)$. \textit{Homotopic maps induce same maps on homology, $j$ is a homotopy equivalence and induce isomorphisms. Hence $\mathcal{B}(f)$ induce isomorphisms between $H_i(BX,R)$ and $H_i(BY,R)$.}
\end{pf}\\

We see two updates. First one is essential, it requires Lemma 3 and operates some equivalence propagating in a chain of length equal to cardinality of $Y$. Second follows automatically from functoriality of all used constructions.

\section{Results}

We start with two obvious observations:

\begin{proposition} ~ \par
  \begin{enumerate}
    \item Let $A$, $B$ be two $\varepsilon$-trivial graded vector spaces. Then $A \oplus B$ is $\varepsilon$-trivial.
    \item Let $A$ and $B$ be two graded vector spaces with at least one of them being $\varepsilon$-trivial. Then $A \otimes_{R_{\bullet}} B$ is $\varepsilon$-trivial ($\bullet$ points that this is a tensor product of graded spaces).
  \end{enumerate}
\end{proposition}

\begin{proposition}
  Let $A$ and $B$ be two persistence topological spaces with at least one of them being $\varepsilon$-acyclic over $\mathbb{F}$. Then $A \star B$ is $\varepsilon$-acyclic over $\mathbb{F}$.
\end{proposition}

\begin{pf}
  Over a field all $Tor$-functors from Proposition 8 vanish since every vector space is free module, hence flat. Hence right hand side of expression of Proposition 8 is $\varepsilon$-trivial by Proposition 9.
\end{pf}

\begin{proposition}
  Let $0 \to \ker{f} \hookrightarrow A \xrightarrow{f} B \xrightarrow{\phi} C \xrightarrow{g} D \to \operatorname{coker}g \to 0$ be exact sequence. Then if $A$ and $D$ are $\varepsilon$-trivial, then $B \stackrel{2\varepsilon}{\sim} C$ with $\phi$ being left morphism in interleaving pair.
\end{proposition}

\begin{pf}
  In s.e.s $0 \to \ker{f} \hookrightarrow A \xrightarrow{f} \operatorname{im}f \to 0$ $\operatorname{im}f$ is $\varepsilon$-trivial. By exactness it is equal to $K = \ker \phi$. On the other side from $0 \to \ker{g} \xrightarrow{g} D \to D \to 0$ there follows that $I = \operatorname{im} \phi$ is $\varepsilon$-trivial. Hence by transitivity $K \stackrel{2\varepsilon}{\sim} I$.\\

  We obtain exact sequence $0 \to K \to B \xrightarrow{\phi} C \to I \to 0$. $B = K \oplus \operatorname{coIm}\phi$, $C = I \oplus \operatorname{Im} \phi$. Coimage and image are canonically isomorphic, hence by Proposition 9 proposition follows.
\end{pf}

\begin{lemma}
  Let $X$ be a persistence poset and for $x=(\ldots,x_i,\ldots) \in X$ either $\mathcal{B}(X_{< x})$ or $\mathcal{B}(X_{> x})$ are $\varepsilon$-acyclic. Then embedding $\mathcal{B}(X \setminus \{x\}) \hookrightarrow \mathcal{B}(X)$ induces $2\varepsilon$-interleavings of all homology modules.
\end{lemma}

Given propositions above the proof is similar to proof of Lemma 3:

\begin{pf} ~ \par
 By Proposition 10 $\mathcal{K}(\operatorname{lk}(\mathcal{N}(x)))$ is $\varepsilon$-acyclic.
 Application of Mayer-Vietoris long exact sequence to covering from Remark 6 and Proposition 11 yield the lemma.
\end{pf}

\begin{definition}
  Let $f = (f_1,\ldots,f_n,\ldots)$ be map of persistence posets $X$ with structure maps $\phi$ and $Y$ with structure maps $\psi$. Then mapping cylinders $M(f_i)$ form persistence poset $M(f)$ with structure maps arising from universal property of coproduct and structure maps of $X$ and $Y$.\\

  To be explicit consider the following diagram in $Cat$ with $i$, $j$ being series of canonical inclusions:\\
  \begin{tikzcd}
  X_{i}\arrow{r}{i_i}\arrow{d}{\phi_{i}} & X_i \coprod Y_i\arrow{d}{\zeta_i} & Y_{i}\arrow{l}{j_i}\arrow{d}{\psi_{i}} \\
  X_{i+1}\arrow{r}{i_{i+1}} & X_{i+1} \coprod Y_{i+1} & Y_{i+1}\arrow{l}{j_{i+1}} \\
  \end{tikzcd}\\
  Notation $i$ for inclusion is kept for consistency with definition of mapping cylinder of posets.

  Existence of order-preserving maps $\zeta_i$ is guaranteed by universal property of coproducts, they are set to be structure maps of $M(f)$. $M(f)$ is a \define{mapping cylinder of map of persistence posets}.\\

  We also have canonical inclusions $i$ and $j$ arising from the same diagram.
\end{definition}

\begin{definition}
  We will denote as \define{linear extension of persistence poset} $X$ series of linear extensions of $X_i$ such with the same structure maps as $X$.
\end{definition}

\begin{proposition}
  Every persistence poset has linear extension.
\end{proposition}

\begin{pf}
  Let $X$ be persistence poset with structure maps $\phi$. We will denote map from $X_i$ as $\phi_i$ and refer to composition of $k$ structure maps as to $\phi^k$ to simplify notation.\\

  For any incomparable pair $a,b$ in $X_i$ one of the following hold:
  \begin{enumerate}
    \item $a \in \operatorname{im}(\phi_{i-1})$, $b \in \operatorname{im}(\phi_{i-1})$. Then we know that preimages are incomparable since $\phi_{i-1}$ is order preserving.
    \item $a \in \operatorname{im}(\phi_{i-1})$, $b \not\in \operatorname{im}(\phi_{i-1})$ or vice versa.
    \item Both $a$ and $b$ are not in image of $\phi_{i-1}$.
  \end{enumerate}

  Assume for some incomparable $a,b$ in $X_i$ $\phi^k(a)$ and $\phi^k(b)$ are comparable for some natural $k$. W.l.o.g $\phi^k(a) \leq \phi^k(b)$. Then we have to add pair $(a,b)$ to order on $X_i$. There is no possible contradiction since pair $(b,a)$ in order implies $\phi^k(b) \leq \phi^k(a)$.\\
  This extension extends infinitely to the left since we never have ordered pair in iterated preimages of $a$ and $b$. If there is no such $k$ we leave ordering on $a,b$ to order extension principle. This extension can be safely extended to both sides.\\

  Application of this reasoning to all poset components and incomparable pairs in them yields proposition.
\end{pf}

\begin{remark}
  While working with persistence topological spaces we sometimes see properties which hold component-wise. If for persistence space $X$ or map $f_i$ there is a property which holds for any $X_i$ or $f_i$ we call it component-wise property of $X$. For instance, if map $f$ is component-wise homotopy equivalence, it induces $0$-interleaving of homology modules.
\end{remark}

Assume $X$ is a persistence linearly ordered set and $Y_i \subset X_i$. Then we can induce structure of persistence linear ordered set on $Y = (\ldots, Y_i, \ldots)$.\\
Let $\phi$ be structure maps of $X$. There is one case there construction of structure maps $\psi$ of $Y$ is nontrivial: image of $\phi_{i-1}$ of some $a \in Y_{i-1}$ is outside of $Y_{i}$. Then we set $\psi(a)$ to be maximal element of $Y_{i}$ such that it is less or equal to $\phi(a)$.\\

We are now ready to adapt known proof to Quillen-McCord theorem for persistence posets.
%Case of coefficients in $\mathbb{Z}$ is better to be considered separately.

\begin{theorem} \textbf{Approximate Quillen-McCord theorem, final statement}\\
  Assume $X, Y$ are persistent posets of finite type, $f : X \to Y$ is order-preserving map, $\mathbb{F}$ is a field. Let $m = \max_{i}(|Y_i|)$ --- maximal cardinality of components of $Y$.\\
  If $\forall y=(\ldots,y_i,\ldots) \in Y\;\mathcal{B}(f^{-1}(Y_{\leqslant y}))$ is $\varepsilon$-acyclic over $\mathbb{F}$, $\mathcal{B}f$ induces $2m\varepsilon$-interleavings of all homology spaces over $\mathbb{F}$ on $BX$ and $BY$.\\
\end{theorem}

\begin{pf} \textbf{Approximate Quillen-McCord theorem}\\
  Let $X, Y$ be persistence posets of finite type with order-preserving map $f : X \to Y$.\\

  Let $\overline{X}$ be linear extension of $X$. Let $x^i_1, x^i_2, \ldots, x^i_{n_i}$ be enumeration of $\overline{X}_i$ in its linear order and $Y_i^r = \{x^i_1,\ldots,x^i_r\} \cup Y_i \subset M(f_i)$ for any $r$ up to $\max_{i}(n_i)$ and $i$. $Y^r = (\ldots, Y_i^r, \ldots)$ is a persistence poset with structure maps induced by structure maps of $M(f)$.\\

  There are posets such that $n_i < r$. In these cases notation $x_r$ means that on positions with $n_i < r$ we take $x_{n_i}$.\\

  Consider $Y^r_{>x_r} = Y_{\geq f(x_r)}$. $\mathcal{B}(Y_{\geq f(x_r)})$ is a component-wise cone over $\mathcal{B}(f(x_r))$. It is component-wise contractible, therefore $\mathcal{B}(Y^{r-1}) \hookrightarrow \mathcal{B}(Y^{r})$ is component-wise homotopy equivalence by lemma 2. By iteration $\mathcal{B}(j) : \mathcal{B}(Y^{0}) = \mathcal{B}(Y) \hookrightarrow \mathcal{B}(M(f)) = \mathcal{B}(Y^n)$ is component-wise homotopy equivalence between $BY$ and $M(f)$. Note that persistence structure is not used here.\\

  Then consider linear extension of $Y$ with enumerations $y^i_1,\ldots,y^i_{m_i}$ and $X_i^r = X \cup \{y^i_{r+1},\ldots,y^i_{m_i}\} \subset M_i(f)$. $X^{r-1}_{\leq y_r} = f^{-1}(Y_{\leqslant y_r})$. Latter is $\varepsilon$-acyclic over $R$ by condition of the theorem. Hence $\mathcal{B}(X^{r}) \hookrightarrow \mathcal{B}(X^{r-1})$ induces $2\varepsilon$-interleavings of all homology modules and by transitivity of $\varepsilon$-equivalence $\mathcal{B}(i)$ induces $2m\varepsilon$-interleavings between homology of $X$ and $M(f)$.\\

  Note that $i(x) \leqslant (j \circ f)(x)$. By Proposition 6 $\mathcal{B}(i)$ is homotopic to $\mathcal{B}(j \circ f) = \mathcal{B}(j) \circ \mathcal{B}(f)$. Homotopic maps induce same maps on homology, $j$ is a homotopy equivalence and induce $0$-interleavings. Hence $\mathcal{B}(f)$ induce $2m\varepsilon$-interleavings between $H_i(BX,R)$ and $H_i(BY,R)$.
\end{pf}

%\begin{proposition}
%  Assume conditions of Theorem 6 and let $R = \mathbb{Z}$. Then $\mathcal{B}f$ induces $2m\varepsilon$-interleavings of all homology modules.
%\end{proposition}
%
%\begin{pf} % stackexchange link.
%  Consider short exact sequence $0 \to \mathbb{Z} \to \mathbb{Q} \to \bigoplus_{p}\mathbb{Z}/p^{\infty}$. It gives rise to long exact sequence $\ldots \to H_{i+1}(X, \bigoplus_{p}\mathbb{Z}/p^{\infty}) \to H_i(X,\mathbb{Z}) \to H_i(X,\mathbb{Q}) \to H_{i}(X, \bigoplus_{p}\mathbb{Z}/p^{\infty})$.\\
%
%
%\end{pf}

\section{Error propagation in Mayer-Vietoris spectral sequence}

Value of error propagation multiple in the result may probably be decreased with alternative proof using spectral sequences. He we outline results of Govc and Scraba on error propagation in one specific spectral sequence associated to cover.

Assume persistence simplicial complex $S$ is a filtered complex (assuming either ascending or descending filtration with any compatible structure maps) and there exists open covering $\mathcal{U}$ compatible with filtration. Then there exists a spectral sequence called Mayer-Vietoris spectral sequence which converges to $H_{\star}(S)$. {\cite[Theorem 2.30]{GS16}}\\

Let all sets in filtered cover $\mathcal{U}$ be $\varepsilon$-acyclic with all intersections between them be $\varepsilon$-acyclic. This is a representation of the definition of $\varepsilon$-acyclic cover. {\cite[Definition 3.2]{GS16}}\\

Sets and all their nonempty intersections in any covering form a poset with inclusion being an order relation. Nerve of this poset is called \define{nerve of a covering} and we shall denote it as $\mathcal{N}(\mathcal{U})$.\\

There hold the following propositions:

\begin{proposition} {\cite[Corollary 5.2]{GS16}}\\
  If $\mathcal{U}$ is an $\varepsilon$-acyclic cover of $X$, then for all $i$ $E^2_{i,0}$ of Mayer-Vietoris spectral sequence and $H_{i}(\mathcal{N}(\mathcal{U}),\mathbb{F})$ are $2\varepsilon$-interleaved as graded modules.
\end{proposition}

\begin{proposition} {\cite[Theorem 7.1]{GS16}}\\
  Let $D$ be dimension of $\mathcal{N}(\mathcal{U})$. Then for all $i$ $H_i(X,\mathbb{F}) \stackrel{(4D+2)\varepsilon}{\sim} H_i(\mathcal{N}(\mathcal{U}),\mathbb{F})$.
\end{proposition}

\section{References}

\begin{enumerate}
  \bibitem[Bar11]{Bar11}
  Jonathan Ariel Barmak. 2011.
  \newblock On Quillen’s Theorem A for posets.
  \newblock J. Comb. Theory Ser. A 118, 8 (November 2011), 2445–2453.
  \newblock DOI:https://doi.org/10.1016/j.jcta.2011.06.008
  \bibitem[Zomorodian05]{Zomorodian05}
  A. Zomorodian and G. Carlsson.
  \newblock Computing persistent homology.
  \newblock In: Discrete and Computational Geometry 33.2 (2005), pp. 249–274.
  \bibitem[GS16]{GS16}
  \bibitem[Corbet18]{Corbet18}
  Corbet, R., Kerber, M.
  \newblock The representation theorem of persistence revisited and generalized.
  \newblock J Appl. and Comput. Topology 2, 1–31 (2018).
  \newblock https://doi.org/10.1007/s41468-018-0015-3
  Govc, Dejan \& Skraba, Primoz. (2016).
  \newblock An Approximate Nerve Theorem.
  \newblock Foundations of Computational Mathematics.
  \newblock 10.1007/s10208-017-9368-6.
  \bibitem[Quillen72]{Quillen72}
  Daniel Quillen,
  \newblock Higher algebraic K-theory, I: Higher K-theories Lect.
  \newblock Notes in Math. 341 (1972), 85-1
  \bibitem[Milnor56]{Milnor56}
  Milnor, J. (1956).
  \newblock Construction of Universal Bundles, II.
  \newblock Annals of Mathematics, 63(3), second series, 430-436.
  \newblock doi:10.2307/1970012
\end{enumerate}

\end{document}
